<!DOCTYPE html>
<html>
    <head>
        <title>POI-Suche in Bochum</title>
    
        <meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"  />
		<meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
		

		<script src="js/leaflet1.0.2.js"></script>
		<script src="dist/Leaflet.ImageOverlay.Rotated.js"></script>
		<script src="js/deps.js"></script>
		<script src="js/leaflet-include.js"></script>
		<script src="dist/leaflet-routing-machine.js"></script>
		<script src="dist/lrm-mapzen.js"></script>
		<script src="dist/lrm-valhalla.js"></script>
		<script src="dist/Control.Geocoder.js"></script>


        <script src="js/label.js"></script>
        <script src="js/Autolinker.min.js"></script>
		<script src="js/easy-button.js"></script>
		<script src="js/Control.Loading.js"></script>
		<script src="js/bouncemarker.js"></script>
		<script src="dist/leaflet.awesome-markers.js"></script>
		<script src="dist/leaflet.ajax.js"></script>
		
		
	
		

		<link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css" />
		<link rel="stylesheet" href="css/leaflet1.0.2.css" />
		<link rel="stylesheet" href="dist/leaflet-routing-machine.css" />
		<link rel="stylesheet" href="css/L.Control.Locate.css" />

        <link rel="stylesheet" type="text/css" href="css/qgis2web.css">
        <link rel="stylesheet" href="css/label.css" />

		<link rel="stylesheet" href="css/easy-button.css" />
		<link rel="stylesheet" href="css/leaflet-gps.css" />
		<link rel="stylesheet" href="css/Control.Loading.css" />
		<link rel="stylesheet" href="dist/leaflet.awesome-markers.css" />

		
		<link rel="stylesheet" href="css/L.Control.Sidebar.css" />
		<link rel="stylesheet" href="css/leaflet-gps.css" />
		<link rel="stylesheet" href="css/leaflet-search.css" />	
		<link rel="stylesheet" href="css/divicon.css" />
		
		
    </head>
	    <style>
        body {
            padding: 0;
            margin: 0;
        }

        html, body, #map {
            height: 100%;
			background-color: rgba(255, 0, 0, 0.0);
        }

        .lorem {
            font-style: calibri;
            color: red;
        }
		
		 #sidebar {		
			font-style: arial;
         
        }
	
    </style>
	
	
    <body>
	    <div id="sidebar">
        <h1>Informationen</h1>

        <p></p>

        <p><b></b></p>

        <p></p>

        <ul>
            <li><a href=></a></li>
            <li><a href=></a></li>
        </ul>

        <p class="lorem">Test</p>

        <p class="lorem">123</p>

        <p class="lorem">Sahira</p>

        <p class="lorem">Kai</p>
    </div>
	
        <div id="map"></div>
        <script src="data/json_Alle.js"></script>
		<script src="data/rahmen1.js"></script>
		<script src="js/leaflet-search.js"></script>
		<script src="js/easy-button.js"></script>
		<script src="js/leaflet-gps.js"></script>
		<script src="js/L.Control.Locate.js" ></script>
		<script src="js/L.Control.Sidebar.js"></script>
		<script src="dist/Leaflet.ImageOverlay.Rotated.js"></script>
	
        <script>
		//Einrichtung der Basiskarte
		var osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
			osmAttrib = '&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors',
			osm = L.tileLayer(osmUrl, {maxZoom: 30});
			
		var OpenStreetMap_BlackAndWhite = L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
		maxZoom: 18,
		minZoom: 17,
		attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
		});
			
			
			
		//Einrichtung der Karte
		var map = L.map('map', {zoomControl: false, rotate: true, touchRotate: false, maxZoom: 30, minZoom: 17,  center: [51.44480, 7.26150]})
				.setView([51.44480, 7.26150], 17)
				.addLayer(osm);
				//.addLayer(OpenStreetMap_BlackAndWhite);
						
				

		//Drehung der Karte um Winkel x		
		var angle = 27.825;
		map.setBearing(angle);	
		
		//Einrichtung der Campuskarte
		var CampusMapLinear = L.tileLayer('http://kairud.111mb.de/MB_Campus/MB_Campus/{z}/{x}/{y}.png',{
		maxZoom: 18,
		minZoom: 17,						//raus zoomen
		center: [51.44480, 7.26150]
		});
		
		//Polygon
		/*var polygon = L.polygon([
			[51.44023, 7.25746],
			[51.44451, 7.27044],
			[51.44867, 7.26471],
			[51.4449, 7.25346]
			], 
			{
			color: 'red',
			fillColor: '#f03',
			fillOpacity: 0.0,
			}
			).addTo(map);*/
			
					//Einrichtung der maxBounds
		/*var southWest = L.latLng([51.44019, 7.2575], map.getMaxZoom()-5);				//[link unten , link oben];
		var northEast = L.latLng([51.45016, 7.26589], map.getMaxZoom()-5);				//[rechts oben , rechts unten];
		mybounds = new L.latLngBounds(southWest, northEast);
		
		//map.setMaxBounds(overlay.getBounds());*/
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------		
		//Einrichtung einer LayerGroup --> für mapOverlays
		var polygone = new L.layerGroup();
		
		//mapOverlays implementieren
		var overlayMaps = {
		//"osm": osm,
		//"Sperrungen": CampusMapLinear,
		"<img src= css/images/Fig._28_-_Divieto_di_transit_nei_due_sensi_-_1959.svg height=25> Sperrungen": CampusMapLinear,
		"<img src= css/images/WBW-Logo_Sommer.svg height=25> Sommerfest": polygone
		};
		
		map.on("zoomstart", function(){
		/*map.dragging.disable();
		map.touchZoom.disable();
		map.doubleClickZoom.disable();
		map.scrollWheelZoom.disable();
		map.boxZoom.disable();
		map.keyboard.disable();*/
		//map.removeLayer(overlay);
		//map.addLayer(CampusMapLinear);
		});
		map.on("zoomend", function(){
		//map.addLayer(overlay);
		/*map.dragging.enable();
		map.touchZoom.enable();
		map.doubleClickZoom.enable();
		map.scrollWheelZoom.enable();
		map.boxZoom.enable();
		map.keyboard.enable();*/
		//map.removeLayer(CampusMapLinear);
		});
		
		
		localStorage.removeItem('alerted');
		
//Standart MarkerIcon für Gebrauch mit Angle 
var smallIcon2 = new L.Icon({
    iconUrl: 'css/images/marker1.png',
    iconRetinaUrl: 'css/images/marker1.png',
    iconSize:    [25, 41],
    iconAnchor:  [12, 41],
    popupAnchor: [1, -34],
    shadowUrl: 'css/images/marker-shadow.png',
    shadowSize:  [41, 41]
});

  var WalkMarker = L.AwesomeMarkers.icon({
    icon: 'fa-male',
	prefix: 'fa',
    markerColor: 'orange',
	//iconColor: '#FC8428'
  });
  
   var CarMarker = L.AwesomeMarkers.icon({
    icon: 'fa-car',
	prefix: 'fa',
    markerColor: 'orange',
	//iconColor: 'black'
  });


var ParkplatzIcon = new L.Icon({
    iconUrl: 'css/images/Parkplatz.png',
    iconRetinaUrl: 'css/images/Parkplatz.png',
    iconSize:    [26, 26],
    iconAnchor:  [45, -32],
    popupAnchor: [1, -34]
});
	
var ParkplatzIcon2 = new L.Icon({
    iconUrl: 'css/images/Parkplatz.png',
    iconRetinaUrl: 'css/images/Parkplatz.png',
    iconSize:    [50, 50],
    iconAnchor:  [88, -63],
    popupAnchor: [1, -34]
});	

		//Marker erstellen zur Vermessung der Koordinaten in der Karte
/*var marker = L.marker([51.44459561, 7.26093000], {
icon: smallIcon2,
draggable: true
}).addTo(map);
marker.bindPopup("Test");
marker.on('click', function(e) {
marker.getPopup().setContent('Clicked' + marker.getLatLng().toString()).openOn(map);
});*/


		
		//mapOverlays der Karte hinzufügen
		L.control.layers(null, overlayMaps, {position: "topright"}).addTo(map);

//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	
		//Simples Imageoverlay einfügen
		//var imageUrl = 'Campusplan_roh.png',
		//imageBounds = [[51.4566, 7.26], [51.4355, 7.27]];

		//L.imageOverlay(imageUrl, imageBounds).addTo(map);
		
//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	
			
		var poppi = L.popup()
		.setContent("Zieh mich an Dein Start/Ziel !");
		
			
			//Routing hinzufügen	
		/*var Control = L.Routing.control({
 waypoints: [
    L.latLng(51.44499, 7.26078),
    L.latLng(51.44375, 7.26185)
  ],
   createMarker: function(i, waypoints, n){ 
   return L.marker(waypoints.latLng, {
					draggable: true,
					bounceOnAdd: true,
					bounceOnAddOptions: {duration: 1000, height: 800, function(){(poppi.openOn(map))}}, 
					
icon: redMarker}).bindPopup(poppi).openPopup();
	},	
	language: 'de',
	routeWhileDragging: true
   //geocoder: L.Control.Geocoder.nominatim(),
   //reverseWaypoints: true
});*/

		var Start = L.latLng(51.44499, 7.26078);	
		var Ziel = L.latLng(51.44375, 7.26185);

var controlWalk = L.Routing.control({
        lineOptions: {
            styles: [
                {color: 'white', opacity: 0.9, weight: 9},
                {color: '#FC8428', opacity: 1, weight: 3}
            ]
        },
waypoints: [
    Start,
	Ziel
  ],
     createMarker: function (i, Start, n){ 
	//for (i = 0; waypoint.length; i++){
   return L.marker (Start.latLng, {
					draggable: true,
					bounceOnAdd: true,
					bounceOnAddOptions: {duration: 1000, height: 800, function(){(bindPopup(poppi).openOn(map))}}, 
					
icon: WalkMarker}).bindPopup(poppi).openPopup();
	//}
	},
	 /*createMarker: function(i, Ziel, n){ 
   return L.marker(Ziel.latLng, {
					draggable: true,
					bounceOnAdd: true,
					bounceOnAddOptions: {duration: 1000, height: 800, function(){(bindPopup(poppi).openOn(map))}}, 
					
icon: CarMarker}).bindPopup(poppi).openPopup();
	},*/
	fitSelectedRoutes: false,
	router: L.Routing.mapzen('mapzen-m7c1Upx', {
    costing: "pedestrian",
	  directions_options: {
      language: 'de',
	 // routeWhileDragging: true
	  }
	  }),	
	  //routeWhileDragging: true,
		//routeWhileDragging: true,
	  formatter: new L.Routing.mapzenFormatter(),
	  reverseWaypoints: true,
	  //geocoder: L.Control.Geocoder.nominatim()
});

var controlCar = L.Routing.control({
waypoints: [
    Start,
	Ziel
  ],
     createMarker: function(i, waypoints, n){ 
   return L.marker(waypoints.latLng, {
					draggable: true,
					bounceOnAdd: true,
					bounceOnAddOptions: {duration: 1000, height: 800, function(){(bindPopup(poppi).openOn(map))}}, 
					
icon: CarMarker}).bindPopup(poppi).openPopup();
	},
	fitSelectedRoutes: false,
	router: L.Routing.mapzen('mapzen-m7c1Upx', {
    costing: "auto",
	   directions_options: {
      language: 'de',
	  }
	  }),	
	  //routeWhileDragging: true,
		//routeWhileDragging: true,
	  formatter: new L.Routing.mapzenFormatter(),
	  reverseWaypoints: true,
	  //geocoder: L.Control.Geocoder.nominatim()
});


//-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	

		//Sidebar einrichten
	   var sidebar = L.control.sidebar('sidebar', {
            closeButton: true,
            position: 'right'
        });
        map.addControl(sidebar);
		sidebar.hide();
		
		//Einrichtung des Loaders/Spinners
		var loadingControl = L.Control.loading({
                    separate: true,	//nicht angedockt am Zoom-Button
					position: 'bottomright'					
                });			
                map.addControl(loadingControl); 
				
				
		//Maßstab einfügen
		//L.control.scale({options: {position: 'bottomleft',maxWidth: 100,metric: true,imperial: false,updateWhenIdle: false}}).addTo(map);
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	
		--> Kann entfernt werden?
		
		//Feature-/Layergroups einrichten
        var feature_group = new L.featureGroup([]);
        var bounds_group = new L.featureGroup([]);
        var raster_group = new L.LayerGroup([]);
	
		//Anordnung der Layer (?)
        var layerOrder = new Array();
        function restackLayers() {
            for (index = 0; index < layerOrder.length; index++) {
                layerOrder[index].bringToFront();
            }
        }
        map.on('overlayadd', restackLayers);
        layerControl = L.control.layers({},{},{collapsed:false});
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	
		
		//PopUp-Inhalt definieren (=popupContent), an sidebar übergeben, die per click auf ein feature geöffnet wird
		//Zur Aktualisierung wird side beim click auf ein weiteres feature zuerst geschlossen und anschließend wieder geöffnet (=Aktualisierung des sidebar-Inhaltes)
        function pop_Alle(feature, layer) {
		
		 layer.on('click', function (e) {
			layer.bringToFront();
			json_AlleJSON.setStyle({fillColor: 'grey', color: 'black'});
			layer.setStyle({radius: 8.0, fillColor: 'red', color: 'black', weight: 1.5});
			//layer.setRadius(15);			
			var sidebarContent = '<table><tr><th scope="row">Bezeichnung</th><td>' + Autolinker.link(String(feature.properties['Bez'])) + '</td></tr><tr><th scope="row">Öffnungszeiten</th><td>' + Autolinker.link(String(feature.properties['NAME'])) + '</td></tr><tr><th scope="row">Telefon/Mobil</th><td>' + Autolinker.link(String(feature.properties['TELEFON'])) + '</td></tr><tr><th scope="row">Internetadresse</th><td>' + Autolinker.link(String(feature.properties['WWW'])) + '</td></tr><tr><th scope="row">E-Mail</th><td>' + Autolinker.link(String(feature.properties['EMAIL'])) + '</td></tr><tr><th scope="row">Hinweis</th><td>' + Autolinker.link(String(feature.properties['BEMERKUNG'])) + '';

			document.getElementById("sidebar").innerHTML = sidebarContent;						//Sidebar-Inhalt zuweisen --> Properties des geclickten features
			//document.getElementById("sidebar").style.fontSize = "15px";						//Sidebar-Schriftgröße ändern
			sidebar.show();
        })};
		
        //Style der Punktsignaturen, die die features des Layers (in dem Fall Alle_json) abbilden -->  Farbe, Radius, Transperanz der Kreise etc.
		function doStyleAlle() {
            return {
                radius: 0.0,
                fillColor: 'grey',
                color: 'black',
                weight: 0.0,
                opacity: 1,
                dashArray: '',
                fillOpacity: 1
	
            }
        };
		
		//Funktion mit der Features des Layers auf Basis des festlegeten Styles (doStyleAlle) abbgebilded werden
        function doPointToLayerAlle(feature, latlng) {
            return L.circleMarker(latlng, doStyleAlle())
        };
	
		//Einbindung der Datei json_AlleJSON als Layer
		/*var json_AlleJSON = new L.geoJson(json_Alle, {
			onEachFeature: pop_Alle,													//für jedes feature wird die function pop_Alle ausgeführt
			pointToLayer: doPointToLayerAlle											//features werden mittels function doPointToLayerAlle und dem darin enhaltenen Verweis auf doStyleAlle als Punkt-Signatures abgebildet
		});	*/
		
		 //var json_AlleJSON = new L.GeoJSON.AJAX("https://github.com/kaio328/Application/blob/master/www/data/json_Alle.js", {
			//onEachFeature: pop_Alle,													//für jedes feature wird die function pop_Alle ausgeführt
		//	pointToLayer: doPointToLayerAlle
			//});
	json_AlleJSON = new L.GeoJSON.AJAX("https://raw.githubusercontent.com/kaio328/Application/master/www/data/json_Alle.geojson", {
		//dataType:"jsonp",
	onEachFeature: pop_Alle,													//für jedes feature wird die function pop_Alle ausgeführt
	pointToLayer: doPointToLayerAlle
	});
	json_AlleJSON.addTo(map);


		
	 
	  //Style festlegen, der für Polygone genutzt wird
		var stylePolygone = {
		"color":  'rgb(7, 48, 87)',
		"weight": 1,
		"opacity": 0.65,
		"fillOpacity": 1
		};
		var styleGrunflaechen = {
		"color": 'rgb(212, 238, 189)',			//"#d4eebdff"
		"weight": 1,
		"opacity": 0.65,
		"fillOpacity": 1
		};
		var styleParken = {
		"color": 'rgb(215, 209, 207)',		//"d7d1cfff"
		"weight": 1,
		"opacity": 0.65,
		"fillOpacity": 1
		};
		var styleRahmen = {
		"color": 'rgb(0, 0, 1)',
		"weight": 2.5,
		"opacity": 1,
		"fillOpacity": 0
		};
		var styleSperrungen = {
		"color": "#000000ff",
		"weight": 1,
		"opacity": 0.65,
		"fillOpacity": 1
		};
		var styleTreppe = {
		"color": "#000000ff",
		"weight": 1,
		"opacity": 0.65,
		"fillOpacity": 1
		};
		var styleUbergange = {
		"color": 'rgb(74, 102, 145)',		//"#4a6691ff",
		"weight": 1,
		"opacity": 0.65,
		"fillOpacity": 1
		};
		
		//add Polygone
		json_rahmenJSON = new L.geoJson(json_rahmen1, {interactive: false, style: styleRahmen}).addTo(polygone);
		//json_grunflaechenJSON = new L.geoJson(json_grunflaechen8, {interactive: false, style: styleGrunflaechen}).addTo(polygone);
		//json_parkenJSON = new L.geoJson(json_parken12, {interactive: false, style: styleParken}).addTo(polygone);
		//json_ubergangeJSON = new L.geoJson(json_ubergange7, {interactive: false, style: styleUbergange}).addTo(polygone);
		//json_polygonJSON = new L.geoJson(json_polygon9, {interactive: false, style: stylePolygone}).addTo(polygone);
		//json_treppeJSON = new L.geoJson(json_treppen4, {interactive: false, style: styleTreppe}).addTo(polygone);
		//json_sperrungenJSON = new L.geoJson(json_sperrungen3, {interactive: false, style: styleSperrungen}).addTo(polygone);
		

//Layergruppe erstellen
var Text = new L.layerGroup([]);
/*Text.on('click', function(e) {
Text.bindPopup("Test");
Text.getPopup().setContent('Clicked' + Text.getLatLng().toString()).openOn(map);
});*/

//Icons und Marker instanziieren, verknüpfen und Layergruppe "Text" zuordnen



//Unicenter
var iconUnicenter = new L.divIcon({
	className: 'leaflet-div-icon-klein-s1',
	iconSize:    [0, 0],
	html: '<b>UNICENTER</b>'
	});	
var Unicenter = L.marker([51.4469, 7.25789], {icon: iconUnicenter});	
Text.addLayer(Unicenter);


//UFO
var iconUFO = new L.divIcon({
	className: 'leaflet-div-icon-klein1',
	iconSize:    [0, 0],
	html: '<b>UFO</b>'
	});	
var UFO = L.marker([51.44728, 7.25938], {icon: iconUFO});	
Text.addLayer(UFO);
//Icons/Marker für Schriftgröße - klein -
--> Übergänge
--> AkaFö, TestDaF, 
--> Parken
--> CC
--> Straßen
--> Sperrungen
--> KITA
--> Forum
--> ZN
--> MSZ

//Universitätsstraße
var iconUniversitätsstrasse = new L.divIcon({
	className: 'leaflet-div-icon-klein0',
	iconSize:    [50, 20],
	html: '<b>Universitätsstrasse</b>'
	});	
var Universitätsstrasse = L.marker([51.44733, 7.26061], {icon: iconUniversitätsstrasse});	
Text.addLayer(Universitätsstrasse);

//I-Nordstraße
var iconInordstraße = new L.divIcon({
	className: 'leaflet-div-icon-klein1-1',
	iconSize:    [50, 20],
	html: '<b>I-Nordstr.</b>'
	});	
var Inordstraße = L.marker([51.44658, 7.26255], {icon: iconInordstraße});	
Text.addLayer(Inordstraße);

//IAN
var iconIAN = new L.divIcon({
	className: 'leaflet-div-icon-klein2',
	iconSize:    [0, 0],
	html: '<b>IAN</b>'
	});	
var IAN = L.marker([51.44677, 7.26119], {icon: iconIAN});	
Text.addLayer(IAN);

//IBN
var iconIBN = new L.divIcon({
	className: 'leaflet-div-icon-klein2',
	iconSize:    [0, 0],
	html: '<b>IBN</b>'
	});	
var IBN = L.marker([51.44723, 7.26227], {icon: iconIBN});	
Text.addLayer(IBN);

//ICN
var iconICN = new L.divIcon({
	className: 'leaflet-div-icon-klein2',
	iconSize:    [0, 0],
	html: '<b>ICN</b>'
	});	
var ICN = L.marker([51.44743, 7.26307], {icon: iconICN});	
Text.addLayer(ICN);

//IDN
var iconIDN = new L.divIcon({
	className: 'leaflet-div-icon-klein2',
	iconSize:    [0, 0],
	html: '<b>IDN</b>'
	});	
var IDN = L.marker([51.44786, 7.26322], {icon: iconIDN});	
Text.addLayer(IDN);

//Sportplatz
var iconSportplatz = new L.divIcon({
	className: 'leaflet-div-icon-mittel',
	iconSize:    [0, 0],
	html: '<b><FONTSIZE="88">HZO</FONT></b>'
	});	
	
//Tennisplatz
var iconTennisplatz = new L.divIcon({
	className: 'leaflet-div-icon-mittel',
	iconSize:    [0, 0],
	html: '<b><FONTSIZE="88">HZO</FONT></b>'
	});	

//CASPO	
var iconCASPO = new L.divIcon({
	className: 'leaflet-div-icon-mittel',
	iconSize:    [0, 0],
	html: '<b><FONTSIZE="88">HZO</FONT></b>'
	});	

//UB
var iconUB = new L.divIcon({
	className: 'leaflet-div-icon-mittel',
	iconSize:    [0, 0],
	html: '<b>UB</b>'
	});		
var UB = L.marker([51.44498, 7.26059], {icon: iconUB});	
Text.addLayer(UB);

//HZO	
var iconHZO = new L.divIcon({
	className: 'leaflet-div-icon-mittel',
	iconSize:    [0, 0],
	html: '<b>HZO</b>'
	});		
var HZO = L.marker([51.44475, 7.262440], {icon: iconHZO});
Text.addLayer(HZO);	

//Mensa	
var iconMensa = new L.divIcon({
	className: 'leaflet-div-icon-mittel',
	iconSize:    [0, 0],
	html: '<b>Mensa</b>'
	});
var Mensa = L.marker([51.44302, 7.26218], {icon: iconMensa});
	Text.addLayer(Mensa);
	
//VZ	
var iconVZ = new L.divIcon({
	className: 'leaflet-div-icon-mittel',
	iconSize:    [0, 0],
	html: '<b>VZ</b>'
	});	
var VZ = L.marker([51.44285, 7.26250], {icon: iconVZ});	
	Text.addLayer(VZ);
	
//MZ	
var iconMZ = new L.divIcon({
	className: 'leaflet-div-icon-mittel',
	iconSize:    [0, 0],
	html: '<b>MZ</b>'
	});	
var MZ = L.marker([51.446, 7.25944], {icon: iconMZ});
	Text.addLayer(MZ);	

	
//UV
var iconUV = new L.divIcon({
	className: 'leaflet-div-icon-mittel-vertikal',
	iconSize:    [0, 0],
	html: '<b>UV</b>'
	});	
var UV = L.marker([51.44597, 7.26029], {icon: iconUV});	
	Text.addLayer(UV);


//Audimax
var iconAudimax = new L.divIcon({
	className: 'leaflet-div-icon-mittel-groß',
	iconSize:    [0, 0],
	html: '<b>Audimax</b>'
	});
var Audimax = L.marker([51.44364, 7.26141], {icon: iconAudimax});	
	Text.addLayer(Audimax);
//Icons für Schriftgröße - Groß -	
-->Icons N-Reihe
-->Icons G-Reihe
-->Icons M-Reihe

//IA
var iconIA = new L.divIcon({
	className: 'leaflet-div-icon-groß',
	iconSize:    [0, 0],
	html: '<b>IA</b>'
	});
var IA = L.marker([51.44615, 7.26236], {icon: iconIA});	
	Text.addLayer(IA);
	
//IB
var iconIB = new L.divIcon({
	className: 'leaflet-div-icon-groß',
	iconSize:    [0, 0],
	html: '<b>IB</b>'
	});
var IB = L.marker([51.44654, 7.26352], {icon: iconIB});	
	Text.addLayer(IB);
	
//IC
var iconIC = new L.divIcon({
	className: 'leaflet-div-icon-groß',
	iconSize:    [0, 0],
	html: '<b>IC</b>'
	});
var IC = L.marker([51.44364, 7.26141], {icon: iconIC});	
	//Text.addLayer(IC);
	
//ID
var iconID = new L.divIcon({
	className: 'leaflet-div-icon-groß',
	iconSize:    [0, 0],
	html: '<b>ID</b>'
	});
var ID = L.marker([51.44364, 7.26141], {icon: iconID});	
	//Text.addLayer(ID);
	
-->BMZ



	//Marker für Signaturen --> Parkplatz
/*var ParplatzMarker = L.marker([51.44439, 7.25584], {
icon: ParkplatzIcon,
draggable: true,
interactive: true
}).addTo(map);*/

/*var markerMeassure = L.marker([51.44511, 7.26069], {
icon: smallIcon2,
draggable: true,
interactive: true
}).addTo(map);
markerMeassure.bindPopup("test");
markerMeassure.on('click', function(e) {
markerMeassure.getPopup().setContent('clicked' + markerMeassure.getLatLng().toString()).openOn(map);
});*/


/*map.on('zoomstart', function () {
	map.removeLayer(Text);
	//map.removeLayer(marker);
	//map.removeLayer(marker2);
	});*/

var visible;
// Attach map zoom handler
map.on('zoomend', function (e) {
    // Check zoom level
    if (map.getZoom() > 17) {
        // Check if not already shown
        if (!visible) {
		//map.addLayer(Text);
		//map.removeLayer(marker);
		//map.addLayer(marker2);
            };
            // Set visibility flag
            visible = true;
        
    } else {
        // Check if not already hidden
        if (visible) {
            // Loop over layers
			//map.removeLayer(Text);
			//map.addLayer(marker);
			//map.removeLayer(marker2);
            };
            // Set visibility flag
            visible = false;
        }
    
});
//map.fitBounds(json_rahmenJSON.getBounds());
//map.setMaxBounds(json_rahmenJSON.getBounds());
//L.rectangle(mybounds, {fillOpacity:0, weight: 3}).addTo(map);	
		
		//Watermark
		
		/*L.Control.Watermark = L.Control.extend({
		onAdd: function(map) {
        var img = L.DomUtil.create('img');

        img.src = 'rub.jpg';
        img.style.width = '500px';
		img.style.margintop = '400px';

        return img;
    },

    onRemove: function(map) {
        // Nothing to do here
    }
});

L.control.watermark = function(opts) {
    return new L.Control.Watermark(opts);
}

L.control.watermark({ position: 'bottomleft' }).addTo(map);*/


		
		
		//Einrichtung der Suchmaske
		//Zunächst Möglichkeit schaffen, nach mehreren Attributen zu suchen
		L.Control.Search.include({
		_searchInLayer: function(layer, retRecords, propName) {
			var that = this,
          loc;

		if (layer instanceof L.Control.Search.Marker) return;

        if (layer instanceof L.Marker || layer instanceof L.CircleMarker) {
          if (that._getPath(layer.options, propName)) {
            loc = layer.getLatLng();
            loc.layer = layer;
            retRecords[that._getPath(layer.options, propName)] = loc;
          } else if (that._getPath(layer.feature.properties, propName)) {
            loc = layer.getLatLng();
            loc.layer = layer;
            retRecords[that._getPath(layer.feature.properties, propName)] = loc;
          } else
            throw new Error("propertyName '" + propName + "' not found in marker");
        } else if (layer.hasOwnProperty('feature')) //GeoJSON
        {
          if (layer.feature.properties.hasOwnProperty(propName)) {
            loc = layer.getBounds().getCenter();
            loc.layer = layer;
            retRecords[layer.feature.properties[propName]] = loc;
          } else
            throw new Error("propertyName '" + propName + "' not found in feature");
        } else if (layer instanceof L.LayerGroup) {
          layer.eachLayer(function(layer) {
            that._searchInLayer(layer, retRecords, propName);
          });
        }
      },

      _recordsFromLayer: function() { //return table: key,value from layer
        var that = this,
          retRecords = {},
          propName = this.options.propertyName;

        if (that._featuresToSearch.length > 0) {
            this._layer.eachLayer(function(layer) {
                for (var i = 0; i < that._featuresToSearch.length; i++) {
                    that._searchInLayer(layer, retRecords, that._featuresToSearch[i]);
                }
            });
        } else {
            this._layer.eachLayer(function(layer) {
                that._searchInLayer(layer, retRecords, propName);
            });
        }
        return retRecords;
      }
    });
	
	//Suche mit angepassten Optionen festlegen
    var searchControl = new L.Control.Search({
        layer: L.featureGroup([json_AlleJSON]),
        //propertyName: 'Nkat',
        position: 'topleft', 
		featuresArray: ['Bez', 'Syn' /*'NAME', 'TELEFON' /*'Hkat', 'Nkat'*/ ],
		animateLocation: true,
        circleLocation: true,
		markerLocation: false,
		zoom: 12});
		
	//Festlegen was ausgeführt werden soll, wenn Suche erfolgreich war
	searchControl.on('search_locationfound', function(e) {
	//map.on('moveend', function(a){		--> bei jedem Pan wird es aktiviert!
	sidebar.hide();
	json_AlleJSON.setStyle({fillColor: 'grey', color: 'black'});
	e.layer.setStyle({radius: 8.0, fillColor: 'red', color: 'black', weight: 1.5});
	e.layer.bringToFront();
	removeButton.enable();
	//}),
	// L.easyButton.addTo(map);         --> klappt nicht!
	});
	map.addControl(searchControl);
	
	
		//Reset-Button einfügen
	var removeButton = L.easyButton('fa fa-times', function(){
	json_AlleJSON.setStyle({radius: 0.0000001, fillColor: 'grey', color: 'grey', weight: 0.000001});		//Style und Radius resetten
	sidebar.hide();																							//sidebar schließen
	//map._layers.removeLayer(that._markerLoc);	
	//map.removeControl(Control);	
		//routingButton.enable();
	//routingButtonWalk.remove();
	//routingWheelChair.remove();
	//routingButton.enable();
	removeButton.disable();
	//map.removeLayer(osm);
	//map.addLayer(CampusMapLinear);
	});
	removeButton.addTo(map);
	removeButton.disable();
	//removeButton.disable();
	
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------				
	
	//Button für Standortsuche implementieren
	L.control.locate({
    strings: {
        title: "Standort anzeigen"
    },	
	locateOptions: {
               timeout: 10000}																				//ist auch der Default-Wert von Leaflet	   
	}).addTo(map);

	//Routing-Button einfügen
	/*var routingButton = L.easyButton('fa fa-location-arrow', function(){
	map.setView([51.44459561, 7.26094000], 17);
	
	//if(map.getCenter() == [51.44459561, 7.26094000]){
	map.setView([51.44459561, 7.2609500], 17);
	sidebar.hide();
	removeButton.enable();
	routingButton.disable();
	Control.addTo(map);
	var alerted = localStorage.getItem('alerted') || '';
    if (alerted != 'yes') {
     alert("Bitte beachte, dass die Routing-Funktion noch in Bearbeitung ist!");
     localStorage.setItem('alerted','yes');
    }
	//map.addLayer(osm);
	//map.removeLayer(CampusMapLinear);
	//} else {
	
	//map.addOneTimeEventListener('moveend', function () {
	//Control.addTo(map);
	//poppi.openOn(map);
	//sidebar.hide();
	//removeButton.enable();
	//map.setView([51.44459561, 7.2609500], 17);
	//})
	//}
	}).addTo(map);*/
	
var routingButton = L.easyButton({
	id: 'routing', 
	type: 'animate',
	states: [{
		stateName: 'add-routing',
		icon:'fa-location-arrow',
		title: 'Routing hinzufügen',
		onClick: function() {
	//function(){
	var alerted = localStorage.getItem('alerted') || '';
    if (alerted != 'yes') {
     //alert("Bitte beachte, dass die Routing-Funktion noch in Bearbeitung ist!");
     localStorage.setItem('alerted','yes');
    }
	routingButtonWalk.addTo(map);
	routingButtonCar.addTo(map);

	//routingButton.disable();
	//removeButton.remove();
	//removeButton.addTo(map);
				this.state('remove-routing');
				routingButtonWalk.state('add-routingWalk');
				routingButtonCar.state('add-routingCar');
	}
	}, {
	    stateName: 'remove-routing',
		title: 'Routing schließen',
		icon: 'fa-location-arrow',
		onClick: function() {
			routingButtonWalk.remove();
			routingButtonCar.remove();
			//routingButton.enable();
			//removeButton.addTo(map);
			//removeButton.remove();
			map.removeControl(controlWalk);
			map.removeControl(controlCar);
				this.state('add-routing');
				    }
	}]
	}).addTo(map);

	var routingButtonWalk = L.easyButton({
	id: 'routing-walk', 
	type: 'animate',
	states: [{
		stateName: 'add-routingWalk',
		icon:'fa fa-male',
		title: 'zu Fuß',
		onClick: function() {
		
	map.setView([51.44459561, 7.26094000], 17);
	//if(map.getCenter() == [51.44459561, 7.26094000]){
	//map.setView([51.44459561, 7.2609500], 17);
	//sidebar.hide();
	//removeButton.addTo(map);
	//routingButton.disable();
	map.removeControl(controlCar);
	//map.removeControl(controlWalk);
	controlWalk.addTo(map);
				this.state('remove-routingWalk');
				routingButtonCar.state('add-routingCar');
	}
	}, {
		stateName: 'remove-routingWalk',
		title: 'zu Fuß',
		icon: 'fa fa-male',
		onClick: function() {
			//routingButtonWalk.remove();
			//routingWheelChair.remove();
			//routingButton.enable();
			//removeButton.addTo(map);
			//removeButton.remove();
			map.removeControl(controlWalk);
				this.state('add-routingWalk');
				    }
	}]
	});
	
	//map.addLayer(osm);
	//map.removeLayer(CampusMapLinear);
	//} else {
	
	//map.addOneTimeEventListener('moveend', function () {
	//Control.addTo(map);
	//poppi.openOn(map);
	//sidebar.hide();
	//removeButton.enable();
	//map.setView([51.44459561, 7.2609500], 17);
	//})
	//}
	
	var routingButtonCar = L.easyButton({
	id: 'routing-car',
	type: 'animate',
	states: [{
		stateName: 'add-routingCar',
		icon:'fa fa-car',
		title: 'per Auto',
	onClick: function(){
	
	map.setView([51.44459561, 7.26094000], 17);
	//if(map.getCenter() == [51.44459561, 7.26094000]){
	map.setView([51.44459561, 7.2609500], 17);
	sidebar.hide();
	//removeButton.addTo(map);
	//routingButton.disable();
	map.removeControl(controlWalk);
	//map.removeControl(controlCar);
	controlCar.addTo(map);
	//Control.getRouter().options.costing = "auto";
				this.state('remove-routingCar');
				routingButtonWalk.state('add-routingWalk');
				}
	}, {
	stateName: 'remove-routingCar',
		title: 'Routing schließen',
		icon: 'fa fa-car',
		onClick: function() {
			//routingButtonWalk.remove();
			//routingWheelChair.remove();
			//routingButton.enable();
			//removeButton.addTo(map);
			//removeButton.remove();
			map.removeControl(controlCar);
				this.state('add-routingCar');
				    }
	}]
	});
	
	
	//map.addLayer(osm);
	//map.removeLayer(CampusMapLinear);
	//} else {
	
	//map.addOneTimeEventListener('moveend', function () {
	//Control.addTo(map);
	//poppi.openOn(map);
	//sidebar.hide();
	//removeButton.enable();
	//map.setView([51.44459561, 7.2609500], 17);
	//})
	//}
	
	
	
	/*var addOsm = L.easyButton('fa fa-exchange', function(){
	map.addLayer(osm);
	map.removeLayer(CampusMapLinear);
	map.removeLayer(overlay);
	addOsm.disable();
	removeOsm.enable();
	}).addTo(map);
	
	
	var removeOsm = L.easyButton('fa fa-exchange', function(){
	map.removeLayer(osm);
	map.addLayer(CampusMapLinear);
	map.addLayer(overlay);
	addOsm.enable();
	removeOsm.disable();
	}).addTo(map);
	removeOsm.disable();
	
	var opacityButton = L.easyButton('fa fa-minus', function(){
	CampusMapLinear.setOpacity(0.0);
	overlay.setOpacity(0.0);
	}).addTo(map);
	
	var opacityButton = L.easyButton('fa fa-plus', function(){
		CampusMapLinear.setOpacity(0.4);
	overlay.setOpacity(0.4);
	}).addTo(map);*/
//--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	
		/*var point1 = L.latLng(51.44539, 7.25305),
		    point2 = L.latLng(51.44972, 7.26602),
		    point3 = L.latLng(51.44021, 7.25749);*/
			
			var point1 = L.latLng(51.446, 7.2525),
		    point2 = L.latLng(51.45034, 7.26549),
		    point3 = L.latLng(51.44021, 7.25749);
			
		/*var marker1 = L.marker(point1, {icon:smallIcon2,  draggable: true} ).addTo(map),
		    marker2 = L.marker(point2, {icon:smallIcon2,  draggable: true} ).addTo(map),
		    marker3 = L.marker(point3, {icon:smallIcon2,  draggable: true} ).addTo(map);*/

		var overlay = L.imageOverlay.rotated("Campusplan_WORK-HERE2.svg", point1, point2, point3, {
			opacity: 1,
			interactive: false,
			attribution: "Campusplan &copy; <a href='http://www.ruhr-uni-bochum.de/'>Ruhr-Universität Bochum</a>"
		});
		
		/*marker1.bindPopup("test");
		marker1.on('click', function(e) {
		marker1.getPopup().setContent('clicked' + marker1.getLatLng().toString()).openOn(map);
		});
		marker2.bindPopup("test");
		marker2.on('click', function(e) {
		marker2.getPopup().setContent('clicked' + marker2.getLatLng().toString()).openOn(map);
		});
		marker3.bindPopup("test");
		marker3.on('click', function(e) {
		marker3.getPopup().setContent('clicked' + marker3.getLatLng().toString()).openOn(map);
		});
		
		function repositionImage() {
			overlay.reposition(marker1.getLatLng(), marker2.getLatLng(), marker3.getLatLng());
		};
		
		marker1.on('drag dragend', repositionImage);
		marker2.on('drag dragend', repositionImage);
		marker3.on('drag dragend', repositionImage);*/
		
// 		var c = overlay.getCanvas2DContext()
		
		//map.addLayer(overlay);
		

		/*overlay.on('dblclick',function (e) {
			console.log('Double click on image.');
			e.stop();
		});

		overlay.on('click',function (e) {
			console.log('Click on image.');
		});*/

		function setOverlayOpacity(opacity) {
			overlay.setOpacity(opacity);
		};
		


		//L.rectangle(, {color: "#ff7800", weight: 1}).addTo(map);

    </script>

</body>
</html>